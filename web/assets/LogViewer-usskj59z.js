import{r as t,i as L,j as e,B as d,R as p,D as S,a0 as y,C,e as b,z as k}from"./index-DMLsphgf.js";import{S as E}from"./switch-BR8PlpcT.js";import{L as R}from"./label-C04T9kgc.js";import{S as I,a as U,b as F,c as V,d as m}from"./select-BeVEnRPh.js";import{H as z}from"./HelpTip-C9GnilBF.js";import{u as T}from"./usePageTitle-CuOKjwOe.js";import{S as B}from"./search-D9wX9al8.js";import"./index-DdraVgRc.js";import"./index-CbU4h7md.js";import"./check-B844v-9Y.js";function J(){T("Logs");const[x,h]=t.useState([]),[o,j]=t.useState("all"),[a,w]=t.useState(""),[n,v]=t.useState(!0),[u,f]=t.useState(null),g=t.useRef(null),r=t.useCallback(async()=>{try{const s=await L("read_gateway_logs",{limit:200});h(s),f(null)}catch(s){h([]),f(s instanceof Error?s.message:String(s))}},[]);t.useEffect(()=>{r()},[r]),t.useEffect(()=>{const s=setInterval(r,15e3);return()=>clearInterval(s)},[r]),t.useEffect(()=>{var s;n&&((s=g.current)==null||s.scrollIntoView({behavior:"smooth"}))},[x,n]);const c=x.filter(s=>!(a&&!s.toLowerCase().includes(a.toLowerCase())||o==="error"&&!s.toLowerCase().includes("error")||o==="warn"&&!s.toLowerCase().includes("warn"))),N=()=>{const s=new Blob([c.join(`
`)],{type:"text/plain"}),l=URL.createObjectURL(s),i=document.createElement("a");i.href=l,i.download=`agentic-console-logs-${new Date().toISOString().slice(0,10)}.txt`,i.click(),URL.revokeObjectURL(l)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:["Logs",e.jsx(z,{text:"View the audit log of everything that's happened — agent actions, errors, and system events. Use the filter and search to find specific entries. Useful for troubleshooting."})]}),e.jsx("p",{className:"text-muted-foreground",children:"System log viewer (auto-refreshing)"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 mr-4",children:[e.jsx(R,{className:"text-sm",children:"Follow"}),e.jsx(E,{checked:n,onCheckedChange:v})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:r,children:[e.jsx(p,{className:"mr-2 h-4 w-4"})," Refresh"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:N,children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(y,{value:a,onChange:s=>w(s.target.value),placeholder:"Search logs...",className:"pl-9"})]}),e.jsxs(I,{value:o,onValueChange:j,children:[e.jsx(U,{className:"w-40",children:e.jsx(F,{})}),e.jsxs(V,{children:[e.jsx(m,{value:"all",children:"All Levels"}),e.jsx(m,{value:"error",children:"Errors"}),e.jsx(m,{value:"warn",children:"Warnings"})]})]})]}),e.jsx(C,{children:e.jsx(b,{className:"p-0",children:e.jsx(k,{className:"h-[calc(100vh-16rem)]",children:e.jsx("div",{className:"p-4 font-mono text-xs space-y-0.5",children:u?e.jsxs("div",{className:"flex flex-col items-center gap-2 py-12 text-destructive text-sm",children:[e.jsxs("p",{children:["Failed to load logs: ",u]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:r,children:[e.jsx(p,{className:"mr-2 h-4 w-4"})," Retry"]})]}):c.length>0?e.jsxs(e.Fragment,{children:[c.map((s,l)=>e.jsx("div",{className:`rounded px-2 py-0.5 break-all ${s.toLowerCase().includes("error")?"bg-red-500/10 text-red-400":s.toLowerCase().includes("warn")?"bg-yellow-500/10 text-yellow-400":"hover:bg-muted"}`,children:s.length>2e3?`${s.slice(0,2e3)}…`:s},l)),e.jsx("div",{ref:g})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2 py-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground font-medium",children:"No logs to display"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-sm",children:a?"No logs match your search. Try a different term or clear the filter.":"Logs will appear here once your agents are running and processing requests."})]})})})})})]})}export{J as default};
