import{r as t,j as e,B as c,R as l,Y as y,C as n,a as d,b as o,E,e as x,l as R,d as L,z as A,i as v,am as T,w as z}from"./index-DMLsphgf.js";import{P as B}from"./progress-CxfYkmZE.js";import{S as i}from"./skeleton-giArBBxK.js";import{H as F}from"./HelpTip-C9GnilBF.js";import{u as H}from"./usePageTitle-CuOKjwOe.js";import{F as P}from"./file-text-ClZp36Wp.js";function Y(){H("Security");const[a,m]=t.useState([]),[u,h]=t.useState([]),[j,p]=t.useState(!0),[g,f]=t.useState(null),[w,S]=t.useState(null),r=async()=>{p(!0),f(null);try{const s=await v("security_audit");m(s)}catch(s){m([]),f(`Security audit failed: ${String(s)}`)}try{const s=await v("read_audit_log",{limit:50});h(s)}catch(s){h([]),S(s instanceof Error?s.message:String(s))}p(!1)};t.useEffect(()=>{r()},[]);const C=a.filter(s=>s.status==="pass").length,N=a.length>0?Math.round(C/a.length*100):0,b=s=>s==="pass"?e.jsx(T,{className:"h-4 w-4 text-green-400"}):s==="warn"?e.jsx(y,{className:"h-4 w-4 text-yellow-400"}):e.jsx(z,{className:"h-4 w-4 text-red-400"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:["Security",e.jsx(F,{text:"Run a security audit to check your configuration â€” sandbox settings, network isolation, credential storage, and tool permissions. Green checks mean you're good."})]}),e.jsx("p",{className:"text-muted-foreground",children:"Local security posture checks"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:r,disabled:j,children:[e.jsx(l,{className:"mr-2 h-4 w-4"})," Re-scan"]})]}),g&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md border border-destructive/20 bg-destructive/10 px-3 py-2 text-sm text-destructive",children:[e.jsx(y,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"flex-1",children:g}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:r,children:[e.jsx(l,{className:"mr-2 h-3 w-3"})," Retry"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(n,{className:"md:col-span-2",children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"})," Security Checks"]})}),e.jsx(x,{className:"space-y-3",children:j?e.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{className:"h-4 w-4 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-4 w-36"}),e.jsx(i,{className:"h-3 w-56"})]})]}),e.jsx(i,{className:"h-5 w-12 rounded-full"})]},s))}):a.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[b(s.status),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.detail})]})]}),e.jsx(R,{variant:s.status==="pass"?"success":s.status==="warn"?"warning":"destructive",children:s.status})]},s.name))})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Risk Score"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-4xl font-bold",children:[N,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Security Score"})]}),e.jsx(B,{value:N})]})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5"})," Audit Log"]}),e.jsx(L,{children:"Recent security-relevant operations"})]}),e.jsx(x,{children:e.jsx(A,{className:"h-64",children:w?e.jsxs("div",{className:"flex flex-col items-center gap-2 text-sm text-destructive text-center py-8",children:[e.jsx("span",{children:"Failed to load audit log"}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:r,children:[e.jsx(l,{className:"mr-2 h-3 w-3"})," Retry"]})]}):u.length>0?e.jsx("div",{className:"space-y-1 font-mono text-xs",children:u.map((s,k)=>e.jsx("div",{className:"rounded px-2 py-1 hover:bg-muted",children:s},k))}):e.jsxs("div",{className:"flex flex-col items-center gap-2 py-8 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:"No audit log entries yet"}),e.jsx("p",{className:"text-xs text-muted-foreground max-w-sm",children:"Entries appear here when your agents perform security-relevant operations like credential access, tool execution, or configuration changes."})]})})})]})]})}export{Y as default};
