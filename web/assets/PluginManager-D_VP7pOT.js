import{r as n,j as e,B as d,R as m,C as g,a as N,M as R,J as k,H as b,b as T,l as $,d as E,e as A,i as w,a3 as r,m as M,g as _,s as B}from"./index-DMLsphgf.js";import{S as F}from"./switch-BR8PlpcT.js";import{L as H}from"./label-C04T9kgc.js";import{S as l}from"./skeleton-giArBBxK.js";import{H as L}from"./HelpTip-C9GnilBF.js";import{u as z}from"./usePageTitle-CuOKjwOe.js";import"./index-DdraVgRc.js";const q={"memory-core":{label:"Memory Core",description:"Persistent memory for agents across conversations. Agents remember context and learn from interactions.",icon:k,recommended:!0},telegram:{label:"Telegram",description:"Connect your agents to Telegram for messaging-based interactions.",icon:R}};function V(){z("Plugins");const[x,u]=n.useState([]),[c,h]=n.useState(!0),[v,f]=n.useState(null),[C,p]=n.useState(!1),[j,y]=n.useState(!1),o=async()=>{h(!0);try{const s=await w("list_gateway_plugins");u(s)}catch(s){r(`Failed to load plugins: ${s instanceof Error?s.message:String(s)}`,"error")}finally{h(!1)}};n.useEffect(()=>{o()},[]);const P=async(s,a)=>{f(s);try{await w("toggle_gateway_plugin",{pluginId:s,enabled:a}),u(t=>t.map(i=>i.id===s?{...i,enabled:a}:i)),p(!0),r(`Plugin "${s}" ${a?"enabled":"disabled"}. Restart the agent engine to apply.`,"success")}catch(t){r(`Failed to toggle plugin: ${t instanceof Error?t.message:String(t)}`,"error")}finally{f(null)}},S=async()=>{y(!0);try{M()==="web"?await _.requestAsync("config.apply",{}):await B("gateway"),p(!1),r("Agent engine restarted. Plugin changes applied.","success")}catch(s){r(`Failed to restart agent engine: ${s instanceof Error?s.message:String(s)}`,"error")}finally{y(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:["Plugins",e.jsx(L,{text:"Plugins extend your agent engine with extra capabilities like persistent memory and messaging integrations."})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage agent engine plugins"})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:o,disabled:c,children:[e.jsx(m,{className:`mr-2 h-4 w-4 ${c?"animate-spin":""}`})," Refresh"]})]}),C&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-amber-500/30 bg-amber-500/5 p-3",children:[e.jsx("p",{className:"text-sm",children:"Plugin configuration changed. Restart the agent engine to apply."}),e.jsx(d,{size:"sm",onClick:S,disabled:j,children:j?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-4 w-4 animate-spin"})," Restarting..."]}):"Restart Engine"})]}),c?e.jsx("div",{className:"space-y-4",children:[1,2].map(s=>e.jsx(g,{children:e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-10 w-10 rounded-lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-28"}),e.jsx(l,{className:"h-3 w-48"})]})]}),e.jsx(l,{className:"h-5 w-9 rounded-full"})]})},s))}):x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(s=>{const a=q[s.id],t=(a==null?void 0:a.icon)??b;return e.jsx(g,{children:e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(t,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs(T,{className:"text-base flex items-center gap-2",children:[(a==null?void 0:a.label)??s.id,(a==null?void 0:a.recommended)&&e.jsx($,{variant:"outline",className:"text-xs",children:"Recommended"})]}),e.jsx(E,{className:"text-sm",children:(a==null?void 0:a.description)??`Agent engine plugin: ${s.id}`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{htmlFor:`plugin-${s.id}`,className:"sr-only",children:["Toggle ",s.id]}),e.jsx(F,{id:`plugin-${s.id}`,checked:s.enabled,disabled:v===s.id,onCheckedChange:i=>P(s.id,i)})]})]})},s.id)})}):e.jsx(g,{children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(b,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground font-medium",children:"No plugins available"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 text-center max-w-sm",children:"Plugins extend your agent engine with capabilities like persistent memory and messaging integrations. Start your agents to discover available plugins."}),e.jsxs(d,{variant:"outline",size:"sm",className:"mt-4",onClick:o,children:[e.jsx(m,{className:"mr-2 h-4 w-4"})," Check Again"]})]})})]})}export{V as default};
