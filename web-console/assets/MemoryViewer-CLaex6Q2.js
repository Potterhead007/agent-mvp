import{c as K,r as t,i as l,j as e,C as M,a as E,b as $,d as P,e as T,B as r,am as Q,a0 as W,z as Y,a3 as g}from"./index-DLzrVyEL.js";import{S as q,a as O,b as G,c as J,d as U}from"./select-Bf3NEO-Y.js";import{H as X}from"./HelpTip-Bf0ngYP4.js";import{C as Z}from"./ConfirmDialog-BoXiTj0F.js";import{u as ee}from"./usePageTitle-BWQ1x_eW.js";import{C as f}from"./circle-alert-ChFoNBvB.js";import{S as se}from"./search-DRTgMfl0.js";import{T as te}from"./trash-2-hOfGscB6.js";import"./index-BmrRr2YK.js";import"./index-C-bnBz93.js";import"./check-BnfHjeKt.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=K("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);function ge(){var A;ee("Memory");const[c,p]=t.useState([]),[a,j]=t.useState(""),[o,D]=t.useState(""),[n,v]=t.useState([]),[R,z]=t.useState(!1),[d,y]=t.useState(!1),[m,S]=t.useState(null),[h,C]=t.useState(!1),[x,N]=t.useState(!1),[I,w]=t.useState(!1),[_,b]=t.useState(null);t.useEffect(()=>{l("list_agents").then(s=>{p(s),b(null),s.length>0&&!a&&j(s[0].id)}).catch(s=>{p([]),b(s instanceof Error?s.message:String(s))})},[]);const[F,k]=t.useState(null),u=async()=>{if(o.trim()){y(!0),z(!0),k(null);try{const s=await l("search_logs",{query:o});v(s)}catch(s){v([]),k(s instanceof Error?s.message:String(s))}finally{y(!1)}}},L=s=>{s.key==="Enter"&&u()},V=async()=>{if(a){C(!0);try{await l("clear_agent_memory",{agentId:a}),g(`Memory cleared for ${i}`,"success")}catch(s){g(`Failed to clear memory: ${s}`,"error")}finally{C(!1)}}},B=async()=>{if(a){N(!0);try{const s=await l("archive_agent_memory",{agentId:a});S(`Memory archived to: ${s}`)}catch(s){g(`Failed to archive memory: ${s}`,"error")}finally{N(!1)}}},i=((A=c.find(s=>s.id===a))==null?void 0:A.name)??a;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:["Memory",e.jsx(X,{text:"Your agent's long-term memory. It stores facts and context from past conversations so it can remember things between sessions. You can search, view, or delete memories."})]}),e.jsx("p",{className:"text-muted-foreground",children:"Agent memory and context management"})]}),c.length>0&&e.jsxs(q,{value:a,onValueChange:j,children:[e.jsx(O,{className:"w-48",children:e.jsx(G,{placeholder:"Select agent"})}),e.jsx(J,{children:c.map(s=>e.jsx(U,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs(M,{children:[e.jsxs(E,{children:[e.jsx($,{className:"text-lg",children:"Context Window"}),e.jsx(P,{children:"Data available when agents are running"})]}),e.jsx(T,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{children:"Start your agents to see context window metrics."})]})})]}),_&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-destructive/20 bg-destructive/10 p-3 text-sm text-destructive",children:[e.jsx(f,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"flex-1",children:"Failed to load agents. Check that agents are configured in the Agents page."}),e.jsx(r,{variant:"ghost",size:"sm",className:"shrink-0",onClick:()=>window.location.reload(),children:"Retry"})]}),m&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border p-3 text-sm",children:[m.startsWith("Failed")?e.jsx(f,{className:"h-4 w-4 text-destructive shrink-0"}):e.jsx(Q,{className:"h-4 w-4 text-green-400 shrink-0"}),e.jsx("span",{children:m}),e.jsx(r,{variant:"ghost",size:"sm",className:"ml-auto",onClick:()=>S(null),"aria-label":"Dismiss notification",children:"Dismiss"})]}),e.jsxs(M,{children:[e.jsx(E,{children:e.jsx($,{className:"text-lg",children:"Memory Search"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"relative flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(se,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(W,{placeholder:"Search agent memory and logs...",className:"pl-9",value:o,onChange:s=>D(s.target.value),onKeyDown:L,"aria-label":"Search agent memory"})]}),e.jsx(r,{onClick:u,disabled:d,children:d?"Searching...":"Search"})]}),R&&e.jsxs("div",{className:"rounded-lg border",children:[F?e.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 text-center text-sm text-destructive",children:[e.jsx("span",{children:"Search failed. Make sure agents are running."}),e.jsx(r,{variant:"ghost",size:"sm",onClick:u,children:"Retry"})]}):n.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:d?"Searching...":"No results found."}):e.jsx(Y,{className:"h-64",children:e.jsx("div",{className:"space-y-0 divide-y",children:n.map((s,H)=>e.jsx("div",{className:"px-3 py-2 text-xs font-mono text-muted-foreground hover:bg-muted/50",children:s},H))})}),n.length>0&&e.jsxs("div",{className:"border-t px-3 py-2 text-xs text-muted-foreground",children:[n.length," result",n.length!==1?"s":""," found"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:B,disabled:!a||x,title:a?void 0:"Select an agent first","aria-label":`Archive memory for ${i}`,children:[e.jsx(ae,{className:`mr-2 h-4 w-4 ${x?"animate-spin":""}`}),x?"Archiving...":"Archive"]}),e.jsxs(r,{variant:"outline",size:"sm",className:"text-destructive",onClick:()=>w(!0),disabled:!a||h,title:a?void 0:"Select an agent first","aria-label":`Clear memory for ${i}`,children:[e.jsx(te,{className:`mr-2 h-4 w-4 ${h?"animate-spin":""}`}),h?"Clearing...":"Clear"]})]})]})]}),e.jsx(Z,{open:I,onOpenChange:w,title:"Clear Agent Memory",description:`This will permanently delete all stored memories for ${i}. This action cannot be undone.`,confirmLabel:"Clear Memory",destructive:!0,onConfirm:V})]})}export{ge as default};
