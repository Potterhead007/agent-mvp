import{c as P,ab as V,r as n,j as e,B as d,C as j,a as C,J as D,b,d as k,e as N,l as O,ac as Z,i as _,a3 as m}from"./index-DLzrVyEL.js";import{S as y,a as v,b as S,c as w,d as M}from"./select-Bf3NEO-Y.js";import{u as $}from"./useConfig-DHY6Oysh.js";import{w as q}from"./config-DtO68tKR.js";import{H as J}from"./HelpTip-Bf0ngYP4.js";import{g as h}from"./models-BN2rvPIS.js";import{u as X}from"./usePageTitle-BWQ1x_eW.js";import{S as Y}from"./save-B-mWaBjp.js";import"./index-BmrRr2YK.js";import"./index-C-bnBz93.js";import"./check-BnfHjeKt.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=P("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),A=[{id:"xai",name:"xAI",models:["grok-4-1-fast-reasoning","grok-3-mini"],color:"bg-blue-500/10 text-blue-400"},{id:"anthropic",name:"Anthropic",models:["claude-opus-4-5-20251101","claude-sonnet-4-20250514","claude-3-5-haiku-20241022"],color:"bg-orange-500/10 text-orange-400"},{id:"openai",name:"OpenAI",models:["gpt-4o","gpt-4o-mini","o1","o3-mini"],color:"bg-green-500/10 text-green-400"},{id:"ollama",name:"Ollama (Local)",models:["llama3.3","mistral","codellama","phi-4"],color:"bg-purple-500/10 text-purple-400"}],K=A.flatMap(l=>l.models);function re(){X("Models");const{config:l,reload:T}=$(),F=V(),[i,x]=n.useState(""),[c,o]=n.useState([]),[I,r]=n.useState(!1),[u,g]=n.useState(null),[f,p]=n.useState({});n.useEffect(()=>{var s;if(l){const a=(s=l.agents)==null?void 0:s.defaults;x((a==null?void 0:a.model)??"grok-4-1-fast-reasoning"),o((a==null?void 0:a.fallbackChain)??["grok-3-mini","gpt-4o","claude-sonnet-4-20250514"])}},[l]);const z=s=>{x(s),r(!0)},B=async s=>{g(s);try{const a=await _("check_health");p(t=>({...t,[s]:a.gateway&&a.dockerRunning}))}catch{p(a=>({...a,[s]:!1})),m("Connection test failed. Check your agents are running.","warning")}finally{g(null)}},E=async()=>{if(!l)return;const s={...l,agents:{...l.agents,defaults:{...l.agents.defaults,model:i,fallbackChain:c}}};try{await q(s),await T(),r(!1),m("Model settings saved","success")}catch(a){m(`Failed to save model config: ${a instanceof Error?a.message:String(a)}`,"error")}},R=s=>{o(a=>a.filter((t,L)=>L!==s)),r(!0)},H=s=>{c.includes(s)||(o(a=>[...a,s]),r(!0))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:["Models",e.jsx(J,{text:"Choose which AI model powers your agents. Pick a primary model, and set up fallbacks in case it's unavailable. You'll need an API key for each provider (add them in Credentials)."})]}),e.jsx("p",{className:"text-muted-foreground",children:"Configure AI model providers and selection"})]}),I&&e.jsxs(d,{onClick:E,size:"sm",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"})," Save Changes"]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:A.map(s=>{const a=s.models.includes(i);return e.jsxs(j,{className:a?"ring-2 ring-primary":"",children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg ${s.color}`,children:e.jsx(D,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx(b,{className:"text-base",children:s.name}),e.jsxs(k,{children:[s.models.length," models available"]})]})]})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs(y,{value:s.models.includes(i)?i:"",onValueChange:z,children:[e.jsx(v,{children:e.jsx(S,{placeholder:"Select default model"})}),e.jsx(w,{children:s.models.map(t=>e.jsx(M,{value:t,children:h(t)},t))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>B(s.id),disabled:u===s.id,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),u===s.id?"Checking...":f[s.id]===!0?"Connected":f[s.id]===!1?"Connection Failed":"Test Connection"]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>F("/credentials"),children:"Configure"})]})]})]},s.id)})}),e.jsxs(j,{children:[e.jsxs(C,{children:[e.jsx(b,{className:"text-lg",children:"Fallback Chain"}),e.jsx(k,{children:"If the primary model fails, try these in order"})]}),e.jsxs(N,{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm flex-wrap",children:c.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-1",children:[a>0&&e.jsx("span",{className:"text-muted-foreground mx-1",children:"â†’"}),e.jsxs(O,{variant:a===0?"default":"outline",className:"gap-1",children:[a+1,". ",h(s),e.jsx("button",{onClick:()=>R(a),className:"ml-1 hover:text-destructive",children:e.jsx(Z,{className:"h-3 w-3"})})]})]},s))}),e.jsxs(y,{onValueChange:H,children:[e.jsx(v,{className:"w-64",children:e.jsx(S,{placeholder:"Add model to chain..."})}),e.jsx(w,{children:K.filter(s=>!c.includes(s)&&s!==i).map(s=>e.jsx(M,{value:s,children:h(s)},s))})]})]})]})]})}export{re as default};
