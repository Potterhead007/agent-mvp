import{c as D,u as _,r as n,i as C,j as e,B as g,L as E,C as p,a as f,b as j,d as B,e as y,R as ae,g as N,U as we,S as ne,f as x,h as le,P as re,k as ie,M as be,l as ke,D as ve,m as Se,n as Ce,o as Ee,p as De,q as Re,s as Ae,t as Ie,v as ze,w as $e}from"./index-DLzrVyEL.js";import{u as Me}from"./useConfig-DHY6Oysh.js";import{H as He}from"./HelpTip-Bf0ngYP4.js";import{u as Ue}from"./usePageTitle-BWQ1x_eW.js";import{P as ce}from"./play-qUrT09cP.js";import{C as _e}from"./circle-alert-ChFoNBvB.js";import{R as Be}from"./rocket-D-37-1MK.js";import"./config-DtO68tKR.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=D("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=D("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=D("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=D("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),P={postgres:"Database",redis:"Cache",gateway:"Agent Engine"};function de(r){if(!r)return"—";const a=Math.floor((Date.now()-r)/1e3);if(a<60)return`${a}s`;const i=Math.floor(a/60);return i<60?`${i}m ${a%60}s`:`${Math.floor(i/60)}h ${i%60}m`}function Fe({label:r,ok:a,loading:i,to:l,highlight:w}){const c=i?e.jsx(E,{className:"h-4 w-4 animate-spin text-muted-foreground"}):a?e.jsx(ze,{className:"h-4 w-4 text-green-500"}):e.jsx($e,{className:"h-4 w-4 text-destructive"}),b=`flex items-center justify-between rounded-md px-2 py-1.5 ${w?"bg-primary/5 ring-1 ring-primary/20":""} ${!a&&l?"hover:bg-muted transition-colors":""}`;return!a&&l?e.jsxs(x,{to:l,className:b,children:[e.jsx("span",{className:"text-sm",children:r}),c]}):e.jsxs("div",{className:b,children:[e.jsx("span",{className:"text-sm",children:r}),c]})}function Xe(){var Z,ee,se;Ue("Dashboard");const r=Se()==="web",{health:a,dockerServices:i,gatewayConnected:l,gatewayConnectedAt:w,milestones:c,setHealth:b,setDockerServices:T}=_(),{config:u,reload:me}=Me(),[k,R]=n.useState(!1),[A,q]=n.useState(!1),[F,L]=n.useState(null),m=n.useRef(null),[I,S]=n.useState(0),[he,z]=n.useState("—"),[G,h]=n.useState(null),[Y,$]=n.useState(!1),[M,V]=n.useState(!1),[o,J]=n.useState(null),[H,O]=n.useState(null),[U,Q]=n.useState(!0),[W,X]=n.useState(null);n.useEffect(()=>{async function t(){Q(!0),X(null);try{const s=await C("check_docker_installed");J(s)}catch(s){J(null),X(s instanceof Error?s.message:String(s))}try{const s=await C("check_backend_exists");O(s)}catch{O(null)}Q(!1)}t()},[]);const xe=(r||(o==null?void 0:o.dockerInstalled)&&(o==null?void 0:o.dockerRunning)&&H&&i.length>0)&&l,ue=((ee=(Z=u==null?void 0:u.agents)==null?void 0:Z.list)==null?void 0:ee.length)??0,ge=(se=u==null?void 0:u.settings)!=null&&se.channels?Object.values(u.settings.channels).filter(t=>t==null?void 0:t.enabled).length:0;n.useEffect(()=>{C("list_skills").then(t=>S(t.length)).catch(()=>S(-1))},[]),n.useEffect(()=>{l&&$(!1)},[l]),n.useEffect(()=>{if(!l){z("—");return}z(de(w));const t=setInterval(()=>{z(de(w))},6e4);return()=>clearInterval(t)},[l,w]),n.useEffect(()=>{a&&(me(),C("list_skills").then(t=>S(t.length)).catch(()=>S(-1)))},[a]),n.useEffect(()=>()=>{m.current&&clearInterval(m.current)},[]);const K=async()=>{R(!0),h(null);try{await Ce();let t=0;m.current&&clearInterval(m.current),m.current=setInterval(async()=>{t++,_.getState().gatewayConnected||N.reconnect();const s=await Ee().catch(()=>null);if(s&&T(s),_.getState().gatewayConnected||t>=20){m.current&&clearInterval(m.current),m.current=null,R(!1);const v=await De().catch(()=>null);v&&b(v)}},2e3)}catch(t){h(String(t)),R(!1)}},pe=async()=>{q(!0),h(null);try{N.disconnect(),await Re(),T([]),b(null)}catch(t){h(String(t))}finally{q(!1)}},fe=async t=>{L(t),h(null);try{await Ae(t),t==="gateway"&&setTimeout(()=>N.reconnect(),1e3)}catch(s){h(String(s))}finally{L(null)}},je=async()=>{V(!0),h(null);try{await Ie(),setTimeout(()=>N.reconnect(),1e3)}catch(t){h(String(t))}finally{V(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:["Dashboard",e.jsx(He,{text:"Your home base. Check if your agents are running and ready, and get an overview of your agents, skills, and channels."})]}),e.jsx("p",{className:"text-muted-foreground",children:"Your agent control center"})]}),!r&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{onClick:K,disabled:k||A,variant:"default",size:"sm",children:k?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"})," Starting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"mr-2 h-4 w-4"})," Start Agents"]})}),e.jsx(g,{onClick:pe,disabled:k||A,variant:"outline",size:"sm",children:A?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"})," Stopping..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"mr-2 h-4 w-4"})," Stop Agents"]})})]})]}),G&&e.jsxs("div",{className:"flex items-start gap-2 rounded-lg border border-destructive/30 bg-destructive/5 p-3 text-sm",children:[e.jsx(_e,{className:"h-4 w-4 text-destructive mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-destructive",children:"Startup error"}),e.jsx("p",{className:"text-muted-foreground mt-1 font-mono text-xs whitespace-pre-wrap max-h-40 overflow-auto",children:G})]})]}),(!xe||!c.firstChat||!c.personalityEdited||!c.skillsExplored)&&(()=>{const t=r?[{label:"Connected",ok:l},{label:"Have your first conversation",ok:c.firstChat,to:"/chat"},{label:"Customize your agent's personality",ok:c.personalityEdited,to:"/agents"},{label:"Explore available skills",ok:c.skillsExplored,to:"/skills"}]:[{label:"System ready",ok:!!(o!=null&&o.dockerInstalled),loading:U},{label:"Agent files ready",ok:!!H,loading:U},{label:"Agents running",ok:i.length>0&&i.some(d=>d.status==="running"),loading:U},{label:"Connected",ok:l},{label:"Have your first conversation",ok:c.firstChat,to:"/chat"},{label:"Customize your agent's personality",ok:c.personalityEdited,to:"/agents"},{label:"Explore available skills",ok:c.skillsExplored,to:"/skills"}],s=t.filter(d=>d.ok).length,v=t.length,te=Math.round(s/v*100),ye=t.findIndex(d=>!d.ok&&!d.loading);return e.jsxs(p,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-lg",children:"Getting Started"}),e.jsx(B,{children:"Complete these steps to get the most out of Agentic Console"})]}),e.jsx(Be,{className:"h-5 w-5 text-primary"})]}),e.jsxs(y,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s," of ",v," complete"]}),e.jsxs("span",{children:[te,"%"]})]}),e.jsx("div",{className:"h-1.5 w-full rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-primary transition-all duration-500",style:{width:`${te}%`}})})]}),W&&e.jsxs("p",{className:"text-xs text-destructive mb-1",children:["System check failed: ",W]}),t.map((d,Ne)=>e.jsx(Fe,{label:d.label,ok:d.ok,loading:d.loading,to:d.to,highlight:Ne===ye},d.label)),!r&&!l&&(o==null?void 0:o.dockerRunning)&&H&&e.jsx(g,{onClick:K,disabled:k,size:"sm",className:"w-full mt-2",children:k?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 animate-spin"})," Starting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"mr-2 h-4 w-4"})," Start Agents"]})})]})]})})(),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(p,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Connection"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:Y,"aria-label":"Reconnect",title:"Reconnect",onClick:()=>{$(!0),N.reconnect(),setTimeout(()=>$(!1),3e3)},children:e.jsx(ae,{className:`h-3.5 w-3.5 ${Y?"animate-spin":""}`})}),l&&e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8","aria-label":"Disconnect",title:"Disconnect",onClick:()=>N.disconnect(),children:e.jsx(we,{className:"h-3.5 w-3.5"})}),e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"})]})]}),e.jsxs(y,{children:[e.jsx(ne,{status:l?"connected":"disconnected"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:l?`Uptime: ${he}`:"Not connected"})]})]}),e.jsx(x,{to:"/agents",className:"block",children:e.jsxs(p,{className:"h-full hover:border-primary/40 transition-colors cursor-pointer",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Agents"}),e.jsx(le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ue}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"configured agents"})]})]})}),e.jsx(x,{to:"/skills",className:"block",children:e.jsxs(p,{className:"h-full hover:border-primary/40 transition-colors cursor-pointer",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Skills"}),e.jsx(re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:I<0?"—":I}),e.jsx("p",{className:"text-xs text-muted-foreground",children:I<0?"unavailable":"installed skills"})]})]})}),e.jsx(x,{to:"/channels",className:"block",children:e.jsxs(p,{className:"h-full hover:border-primary/40 transition-colors cursor-pointer",children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Channels"}),e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ge}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"active channels"})]})]})})]}),e.jsxs(p,{children:[e.jsxs(f,{className:"pb-3",children:[e.jsx(j,{className:"text-lg",children:"Quick Actions"}),e.jsx(B,{children:"Jump right in — here are the most common things to do"})]}),e.jsx(y,{children:e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(x,{to:"/chat",className:"flex items-center gap-3 rounded-lg border p-3 transition-colors hover:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(be,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Chat with your agent"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start a conversation"})]})]}),e.jsxs(x,{to:"/channels",className:"flex items-center gap-3 rounded-lg border p-3 transition-colors hover:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-blue-500/10",children:e.jsx(ie,{className:"h-4 w-4 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Connect a channel"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Telegram, Discord, Slack"})]})]}),e.jsxs(x,{to:"/skills",className:"flex items-center gap-3 rounded-lg border p-3 transition-colors hover:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-purple-500/10",children:e.jsx(re,{className:"h-4 w-4 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Browse skills"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Extend what your agent can do"})]})]}),e.jsxs(x,{to:"/agents",className:"flex items-center gap-3 rounded-lg border p-3 transition-colors hover:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-orange-500/10",children:e.jsx(le,{className:"h-4 w-4 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Manage agents"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Create or customize agents"})]})]})]})})]}),e.jsxs(p,{children:[e.jsxs(f,{children:[e.jsx(j,{className:"text-lg",children:"Agent Infrastructure"}),e.jsx(B,{children:"Components that power your agents behind the scenes"})]}),e.jsx(y,{children:(()=>{const t=i.length>0?i:r&&a?[{name:"gateway",status:a.gateway?"running":"stopped",health:a.gateway?"healthy":"unhealthy"},{name:"postgres",status:a.postgres?"running":"stopped",health:a.postgres?"healthy":"unhealthy"},{name:"redis",status:a.redis?"running":"stopped",health:a.redis?"healthy":"unhealthy"}]:[];return t.length>0?e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.name==="postgres"&&e.jsx(Pe,{className:"h-4 w-4"}),s.name==="redis"&&e.jsx(Te,{className:"h-4 w-4"}),s.name==="gateway"&&e.jsx(oe,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:P[s.name]??s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{status:s.status==="running"?"running":"stopped"}),s.health!=="N/A"&&e.jsx(ke,{variant:"outline",children:s.health}),!r&&s.name==="gateway"&&e.jsxs(g,{variant:"ghost",size:"sm",className:"h-8 gap-1.5 text-xs",disabled:M,title:"Download the latest agent engine version and restart",onClick:je,children:[e.jsx(ve,{className:`h-3.5 w-3.5 ${M?"animate-pulse":""}`}),M?"Updating...":"Update"]}),!r&&e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8","aria-label":`Restart ${P[s.name]??s.name}`,title:`Restart ${P[s.name]??s.name}`,disabled:F===s.name,onClick:()=>fe(s.name),children:e.jsx(ae,{className:`h-3.5 w-3.5 ${F===s.name?"animate-spin":""}`})})]})]},s.name))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:a!=null&&a.dockerRunning?"No components detected. Check Settings to make sure everything is configured.":"Your agents aren't running. Click Start Agents above or check Settings."})})()})]})]})}export{Xe as default};
